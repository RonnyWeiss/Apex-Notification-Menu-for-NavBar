var notificationMenu=function(){"use strict";var o={version:"1.0.1",escapeHTML:function(o){if(null===o)return null;if(void 0!==o){if("object"==typeof o)try{o=JSON.stringify(o)}catch(o){}try{return apex.util.escapeHTML(String(o))}catch(r){return(o=String(o)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}}},jsonSaveExtend:function(o,r){var a={};if("string"==typeof r)try{r=JSON.parse(r)}catch(o){console.error("Error while try to parse udConfigJSON. Please check your Config JSON. Standard Config will be used."),console.error(o),console.error(r)}else a=r;try{a=$.extend(!0,o,r)}catch(r){console.error("Error while try to merge udConfigJSON into Standard JSON if any attribute is missing. Please check your Config JSON. Standard Config will be used."),console.error(r),a=o,console.error(a)}return a}};return{initialize:function(r,a,e,n,t){function l(o){if(a)apex.server.plugin(a,{pageItems:n},{success:o,error:function(r){console.log(r.responseText),o({row:[{NOTE_ICON:"fa-exclamation-triangle",NOTE_ICON_COLOR:"#FF0000",NOTE_HEADER:"Error occured!",NOTE_TEXT:"Error occured while try to get new data.",NOTE_COLOR:"#FF0000"}]})},dataType:"json"});else try{i(dataJSON)}catch(o){console.log("need data json"),console.log(o)}}function i(a){!1!==t&&(c.counterBackgroundColor=o.escapeHTML(c.counterBackgroundColor),c.counterFontColor=o.escapeHTML(c.counterFontColor),c.mainIcon=o.escapeHTML(c.mainIcon),c.mainIconBackgroundColor=o.escapeHTML(c.mainIconBackgroundColor),c.mainIconColor=o.escapeHTML(c.mainIconColor));var e=$("<div></div>");e.addClass("toggleNotifications"),e.attr("id",r+"_toggleNote"),e.attr("toggled","true");var n="#"+r+"_ul";e.on("touchstart click",function(){var o="false"==e.attr("toggled")?"true":"false";e.attr("toggled",o),$(n).fadeToggle("fast")}),$(document).on("touchstart click",function(o){!e.is(o.target)&&0===e.has(o.target).length&&!$(o.target).parents(n).length>0&&"false"==e.attr("toggled")&&(e.attr("toggled",!0),$(n).fadeToggle("fast"))});var l=$("<div></div>");l.addClass("count"),e.append(l);var i=$("<div></div>");i.addClass("num"),i.css("background",c.counterBackgroundColor),i.css("color",c.counterFontColor),i.attr("id",r+"_numdiv"),i.html(a.row.length),l.append(i);var g=$("<label></label>");g.addClass("show"),g.css("background",c.mainIconBackgroundColor);var u=$("<i></i>");u.addClass("fa"),u.addClass(c.mainIcon),u.css("color",c.mainIconColor),c.mainIconBlinking&&u.addClass("fa-blink"),g.append(u),e.append(g),d.append(e),s(a)}function s(a){var e="#"+r+"_toggleNote";if($(e).hide(),a.row){var n="#"+r+"_numdiv",l="#"+r+"_ul";a.row.length>0?($(n).css("background",c.counterBackgroundColor),$(e).show(),$(n).show(),$(n).text(a.row.length),$(l).remove(),function(a,e){var n=$("<ul></ul>");n.attr("id",r+"_ul"),n.addClass("notifications"),n.addClass("notificationstoggle");var l="#"+r+"_toggleNote";"false"==$(l).attr("toggled")&&n.toggle();if(e.row)for(var i=0;i<e.row.length;i++){!1!==t&&(e.row[i].NOTE_HEADER&&(e.row[i].NOTE_HEADER=o.escapeHTML(e.row[i].NOTE_HEADER)),e.row[i].NOTE_ICON&&(e.row[i].NOTE_ICON=o.escapeHTML(e.row[i].NOTE_ICON)),e.row[i].NOTE_ICON_COLOR&&(e.row[i].NOTE_ICON_COLOR=o.escapeHTML(e.row[i].NOTE_ICON_COLOR)),e.row[i].NOTE_TEXT&&(e.row[i].NOTE_TEXT=o.escapeHTML(e.row[i].NOTE_TEXT)));var s=$("<a></a>");e.row[i].NOTE_LINK&&(s.attr("href",e.row[i].NOTE_LINK),c.linkTargetBlank&&s.attr("target","_blank"),s.on("touchstart click",function(o){"false"==a.attr("toggled")&&(a.attr("toggled",!0),$(n).fadeToggle("fast"))}));var d=$("<li></li>");d.addClass("note"),e.row[i].NOTE_COLOR&&d.css("box-shadow","-5px 0 0 0 "+e.row[i].NOTE_COLOR);var g=$("<div></div>");g.addClass("note-header");var u=$("<i></i>");u.addClass("fa"),e.row[i].NOTE_ICON&&u.addClass(e.row[i].NOTE_ICON),e.row[i].NOTE_ICON_COLOR&&u.css("color",e.row[i].NOTE_ICON_COLOR),u.addClass("fa-lg"),g.append(u),e.row[i].NOTE_HEADER&&g.append(e.row[i].NOTE_HEADER),d.append(g);var O=$("<span></span>");O.addClass("note-info"),e.row[i].NOTE_TEXT&&O.html(e.row[i].NOTE_TEXT),d.append(O),s.append(d),n.append(s)}$("body").append(n)}($(e),a)):(c.showAlways&&($(e).show(),$(n).hide()),$(l).remove())}}var c={};c=o.jsonSaveExtend({refresh:0,mainIcon:"fa-bell",mainIconColor:"white",mainIconBackgroundColor:"rgba(70,70,70,0.9)",mainIconBlinking:!1,counterBackgroundColor:"rgb(232, 55, 55 )",counterFontColor:"white",linkTargetBlank:!0,showAlways:!1},e);var d=function(o){var r=$("<li></li>");r.addClass("t-NavigationBar-item");var e=$("<div></div>");return e.attr("id",o),e.bind("apexrefresh",function(){0==d.children("span").length&&(a?l(s):s(dataJSON))}),r.append(e),$(".t-NavigationBar").prepend(r),e}(r);l(i),c.refresh>0&&setInterval(function(){0==d.children("span").length&&(a?l(s):s(dataJSON))},1e3*c.refresh)}}}();