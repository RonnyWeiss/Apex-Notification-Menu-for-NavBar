var notificationMenu=function(){"use strict";var o={version:"1.0.5",isAPEX:function(){return"undefined"!=typeof apex},debug:{info:function(r){o.isAPEX()&&apex.debug.info(r)},error:function(r){o.isAPEX()?apex.debug.error(r):console.error(r)}},escapeHTML:function(r){if(null===r)return null;if(void 0!==r){if("object"==typeof r)try{r=JSON.stringify(r)}catch(o){}return o.isAPEX()?apex.util.escapeHTML(String(r)):(r=String(r)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}},jsonSaveExtend:function(o,r){var e={};if("string"==typeof r)try{r=JSON.parse(r)}catch(o){console.error("Error while try to parse targetConfig. Please check your Config JSON. Standard Config will be used."),console.error(o),console.error(r)}else e=r;try{e=$.extend(!0,o,r)}catch(r){console.error("Error while try to merge 2 JSONs into standard JSON if any attribute is missing. Please check your Config JSON. Standard Config will be used."),console.error(r),e=o,console.error(e)}return e}};return{initialize:function(r,e,a,n,t){function i(r){if(e)apex.server.plugin(e,{pageItems:n},{success:r,error:function(e){o.debug.error(e.responseText),r({row:[{NOTE_ICON:"fa-exclamation-triangle",NOTE_ICON_COLOR:"#FF0000",NOTE_HEADER:"Error occured!",NOTE_TEXT:"Error occured while try to get new data.",NOTE_COLOR:"#FF0000"}]})},dataType:"json"});else try{s(dataJSON)}catch(r){o.debug.error("need data json"),o.debug.error(r)}}function s(e){!1!==t&&(l.counterBackgroundColor=o.escapeHTML(l.counterBackgroundColor),l.counterFontColor=o.escapeHTML(l.counterFontColor),l.mainIcon=o.escapeHTML(l.mainIcon),l.mainIconBackgroundColor=o.escapeHTML(l.mainIconBackgroundColor),l.mainIconColor=o.escapeHTML(l.mainIconColor));var a=$("<div></div>");a.addClass("toggleNotifications"),a.attr("id",r+"_toggleNote"),a.attr("toggled","true");var n="#"+r+"_ul";a.on("touchstart click",function(){var o="false"==a.attr("toggled")?"true":"false";a.attr("toggled",o),$(n).fadeToggle("fast")}),$(document).on("touchstart click",function(o){!a.is(o.target)&&0===a.has(o.target).length&&!$(o.target).parents(n).length>0&&"false"==a.attr("toggled")&&(a.attr("toggled",!0),$(n).fadeToggle("fast"))});var i=$("<div></div>");i.addClass("count"),a.append(i);var s=$("<div></div>");s.addClass("num"),s.css("background",l.counterBackgroundColor),s.css("color",l.counterFontColor),s.attr("id",r+"_numdiv"),s.html(e.row.length),i.append(s);var g=$("<label></label>");g.addClass("show"),g.css("background",l.mainIconBackgroundColor);var u=$("<i></i>");u.addClass("fa"),u.addClass(l.mainIcon),u.css("color",l.mainIconColor),l.mainIconBlinking&&u.addClass("fa-blink"),g.append(u),a.append(g),d.append(a),c(e)}function c(e){var a="#"+r+"_toggleNote";if($(a).hide(),e.row){var n="#"+r+"_numdiv",i="#"+r+"_ul";e.row.length>0?($(n).css("background",l.counterBackgroundColor),$(a).show(),$(n).show(),$(n).text(e.row.length),$(i).remove(),function(e,a){var n="",i=$("<ul></ul>");i.attr("id",r+"_ul"),i.addClass("notifications"),i.addClass("notificationstoggle");var s="#"+r+"_toggleNote";"false"==$(s).attr("toggled")&&i.toggle();if(a.row)for(var c=0;c<a.row.length;c++){!1!==t&&(a.row[c].NOTE_HEADER&&(a.row[c].NOTE_HEADER=o.escapeHTML(a.row[c].NOTE_HEADER)),a.row[c].NOTE_ICON&&(a.row[c].NOTE_ICON=o.escapeHTML(a.row[c].NOTE_ICON)),a.row[c].NOTE_ICON_COLOR&&(a.row[c].NOTE_ICON_COLOR=o.escapeHTML(a.row[c].NOTE_ICON_COLOR)),a.row[c].NOTE_TEXT&&(a.row[c].NOTE_TEXT=o.escapeHTML(a.row[c].NOTE_TEXT)));var d=$("<a></a>");a.row[c].NOTE_LINK&&(d.attr("href",a.row[c].NOTE_LINK),l.linkTargetBlank&&d.attr("target","_blank"),d.on("touchstart click",function(o){"false"==e.attr("toggled")&&(e.attr("toggled",!0),$(i).fadeToggle("fast"))}));var g=$("<li></li>");g.addClass("note"),a.row[c].NOTE_COLOR&&g.css("box-shadow","-5px 0 0 0 "+a.row[c].NOTE_COLOR);var u=$("<div></div>");u.addClass("note-header");var f=$("<i></i>");f.addClass("fa"),a.row[c].NOTE_ICON&&f.addClass(a.row[c].NOTE_ICON),a.row[c].NOTE_ICON_COLOR&&f.css("color",a.row[c].NOTE_ICON_COLOR),f.addClass("fa-lg"),u.append(f),a.row[c].NOTE_HEADER&&u.append(a.row[c].NOTE_HEADER),g.append(u);var O=$("<span></span>");O.addClass("note-info"),a.row[c].NOTE_TEXT&&O.html(a.row[c].NOTE_TEXT),g.append(O),d.append(g),i.append(d),l.useBrowserNotificationAPI&&a.row[c].BROWSER_NOTIFICATION&&a.row[c].BROWSER_NOTIFICATION.length>0&&(n+="â€¢ "+a.row[c].BROWSER_NOTIFICATION+"\n")}if($("body").append(i),l.useBrowserNotificationAPI&&n.length>0)if("Notification"in window)if("granted"===Notification.permission)new Notification("ðŸ””",{body:n});else"denied"!==Notification.permission&&Notification.requestPermission(function(o){if("granted"===o)new Notification("ðŸ””",{body:n})});else o.debug.Error("This browser does not support system notifications")}($(a),e)):(l.showAlways&&($(a).show(),$(n).hide()),$(i).remove())}}var l={};l=o.jsonSaveExtend({refresh:0,mainIcon:"fa-bell",mainIconColor:"white",mainIconBackgroundColor:"rgba(70,70,70,0.9)",mainIconBlinking:!1,counterBackgroundColor:"rgb(232, 55, 55 )",counterFontColor:"white",linkTargetBlank:!0,showAlways:!1},a);var d=function(o){var r=$("<li></li>");r.addClass("t-NavigationBar-item");var a=$("<div></div>");return a.attr("id",o),a.bind("apexrefresh",function(){0==d.children("span").length&&(e?i(c):c(dataJSON))}),r.append(a),$(".t-NavigationBar").prepend(r),a}(r);l.useBrowserNotificationAPI&&("Notification"in window?Notification.requestPermission():o.debug.error("This browser does not support system notifications")),i(s),l.refresh>0&&setInterval(function(){0==d.children("span").length&&(e?i(c):c(dataJSON))},1e3*l.refresh)}}}();